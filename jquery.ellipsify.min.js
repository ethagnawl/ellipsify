(function(h){h.fn.ellipsify=function(g){function k(d,b,e){var c,l=d[b-1];if(a.split_join===i)for(c=0;c<b;c+=1)if(d[c]===j)b+=1;if(/\.$/.test(l))d[b-1]=l.replace(".",i);e.next().length&&e.nextAll().remove();e.addClass(a.ellipsify_class).html(d.slice(0,b).join(a.split_join)+a.ellip)}var i="",j=" ",a={count:25,ellip:"...",ellipsify_class:"ellipsis",split_join:j,type:"words"},m=this.length;if(g){h.extend(a,g);a.split_join=a.type==="words"?j:i}if(!(m<1)){if(m===1){g=this.get(0).innerHTML.split(a.split_join);
if(g.length<a.count)return;else k(g,a.count,this)}else{var f={count:0};h.each(this,function(d){var b=h(this),e=b.get(0).innerHTML.split(a.split_join),c=e.length;f.prev=d-1;if(c+f.count<a.count)f.count+=c;else k(e,f.prev<0?a.count:a.count-f.previous_length,b);f.previous_length=c})}return this}}})(jQuery);
